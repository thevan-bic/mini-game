var t=Object.defineProperty,e=(e,i,s)=>((e,i,s)=>i in e?t(e,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[i]=s)(e,"symbol"!=typeof i?i+"":i,s);import{r as i}from"./phaser-UvlxNa5i.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const i of t)if("childList"===i.type)for(const t of i.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var s=i();class o extends Phaser.Scene{constructor(){super({key:"GameScene"}),e(this,"toolHighlight"),e(this,"gridHighlight"),e(this,"gridData"),e(this,"gridItems",{}),e(this,"droppedItems",[]),e(this,"selectedTool"),e(this,"selectedGrid"),e(this,"floorNumberText"),e(this,"itemAmountTexts",{}),e(this,"character"),e(this,"characterPosition",{row:5,col:5}),e(this,"isMoving",!1),e(this,"gridStartX",399.357),e(this,"gridStartY",557.491),e(this,"cellSize",80),e(this,"bgMusic"),e(this,"pickSound"),e(this,"drillSound"),e(this,"mineSound"),e(this,"radarSound"),e(this,"collectSound"),e(this,"errorSound"),e(this,"walkSound"),e(this,"gameState",{currentFloor:1,items:{Pick:3,Drill:2,Mine:1,Radar:2}})}preload(){this.load.tilemapTiledJSON("gameMap","/assets/tilemap.json"),this.load.spritesheet("h_resource_tiles","/assets/h-resource.png",{frameWidth:80,frameHeight:80}),this.load.spritesheet("game_item_tiles","/assets/game-item.png",{frameWidth:160,frameHeight:160}),this.load.image("floor","/assets/floor.png"),this.load.image("line","/assets/line.png"),this.load.image("next_button","/assets/next-button.png"),this.load.image("menu_item_bg","/assets/menu-item.png"),this.load.image("background","/assets/background.png"),this.load.image("main_bg","/assets/main.png"),this.load.image("stone","/assets/stone.png"),this.load.image("item_drill","/assets/items/drill.png"),this.load.image("item_mine","/assets/items/mine.png"),this.load.image("item_radar","/assets/items/radar.png"),this.load.image("item_pick","/assets/items/pick.png"),this.load.image("item_gem","/assets/items/gem.png"),this.load.image("item_medal","/assets/items/medal.png"),this.load.image("character","/assets/character.png"),this.load.image("cursor","/assets/cursor.png"),this.load.audio("bgMusic",["/assets/music/stage/stage-theme.mp3"]),this.load.audio("pickSound",["/assets/music/pick.mp3"]),this.load.audio("drillSound",["/assets/music/drill.mp3"]),this.load.audio("mineSound",["/assets/music/bomb/explosion1.mp3"]),this.load.audio("radarSound",["/assets/music/radar.mp3"]),this.load.audio("collectSound",["/assets/music/character/power-up.wav"]),this.load.audio("errorSound",["/assets/music/character/power-up.wav"]),this.load.audio("walkSound",["/assets/music/character/walk.mp3","/assets/music/character/walk-2.mp3"])}async create(){this.textures.exists("stone")?console.log("Stone texture loaded successfully"):console.error("Stone texture not found! Check if /assets/stone.png exists"),this.initializeAudio(),this.input.setDefaultCursor("url(/assets/cursor.png), pointer"),await this.loadGridFromServer();const t=this.add.tilemap("gameMap");t.addTilesetImage("floor","floor"),t.addTilesetImage("line","line"),t.addTilesetImage("next-button","next_button"),t.addTilesetImage("menu-item","menu_item_bg"),t.addTilesetImage("background","background"),t.addTilesetImage("main","main_bg"),this.createObjectLayers(t),this.createGridZones(t),this.cameras.main.setZoom(.6),this.cameras.main.centerOn(640,800),this.createHighlightGraphics(),console.log("Game state initialized:",this.gameState),this.selectedTool=null,this.selectedGrid=null,this.createGridTiles(),this.createCharacter(),this.setupInputControls(),this.time.delayedCall(200,(()=>{this.updateItemDisplay(),console.log("Initial item display updated")}))}initializeAudio(){this.sound.get("bgMusic")?this.bgMusic=this.sound.get("bgMusic"):(this.bgMusic=this.sound.add("bgMusic",{loop:!0,volume:.5}),this.bgMusic.play()),this.pickSound=this.sound.add("pickSound",{volume:.7}),this.drillSound=this.sound.add("drillSound",{volume:.7}),this.mineSound=this.sound.add("mineSound",{volume:.8}),this.radarSound=this.sound.add("radarSound",{volume:.6}),this.collectSound=this.sound.add("collectSound",{volume:.8}),this.errorSound=this.sound.add("errorSound",{volume:.6}),this.walkSound=this.sound.add("walkSound",{volume:.4})}createCharacter(){const t=this.gridStartX+this.characterPosition.col*this.cellSize,e=this.gridStartY+this.characterPosition.row*this.cellSize;this.character=this.add.sprite(t,e,"character"),this.character.setOrigin(0,0),this.character.setDisplaySize(this.cellSize,this.cellSize),this.character.setDepth(10),console.log(`Character created at position ${this.characterPosition.row}x${this.characterPosition.col}`)}setupInputControls(){var t,e,i;const s=null==(t=this.input.keyboard)?void 0:t.createCursorKeys(),o=null==(e=this.input.keyboard)?void 0:e.addKeys("W,S,A,D");this.input.on("pointerdown",(t=>{const e=this.input.hitTestPointer(t);let i=!1;for(const s of e)if(s.name&&s.name.includes("x")&&!s.name.includes("dropped")){i=!0;break}i||this.selectedTool||this.handleClickToMove(t.worldX,t.worldY)})),s&&o&&(null==(i=this.input.keyboard)||i.on("keydown",(t=>{if(this.isMoving)return;let e=this.characterPosition.row,i=this.characterPosition.col;switch(t.code){case"KeyW":case"ArrowUp":e--;break;case"KeyS":case"ArrowDown":e++;break;case"KeyA":case"ArrowLeft":i--;break;case"KeyD":case"ArrowRight":i++;break;default:return}this.moveCharacterTo(e,i)})))}handleClickToMove(t,e){if(this.isMoving||this.selectedTool)return;const i=this.gridStartX+6*this.cellSize,s=this.gridStartY+6*this.cellSize;if(t<this.gridStartX||t>i||e<this.gridStartY||e>s)return;const o=Math.floor((t-this.gridStartX)/this.cellSize),a=Math.floor((e-this.gridStartY)/this.cellSize),r=Math.max(0,Math.min(5,a)),l=Math.max(0,Math.min(5,o));console.log(`Click to move: ${r}x${l}`),this.moveCharacterTo(r,l)}moveCharacterTo(t,e){if(this.isMoving)return;if(t<0||t>5||e<0||e>5)return;const i=this.findPath(this.characterPosition.row,this.characterPosition.col,t,e);0!==i.length?this.executeMovementPath(i):console.log("Noway!")}findPath(t,e,i,s){const o=[],a=new Set;o.push({row:t,col:e,path:[{row:t,col:e}]});const r=[{row:-1,col:0},{row:1,col:0},{row:0,col:-1},{row:0,col:1}];for(;o.length>0;){const t=o.shift(),e=`${t.row},${t.col}`;if(!a.has(e)){if(a.add(e),t.row===i&&t.col===s)return t.path.slice(1);for(const e of r){const i=t.row+e.row,s=t.col+e.col,r=`${i},${s}`;if(i<0||i>5||s<0||s>5)continue;if(a.has(r))continue;const l=`${i}x${s}`;this.gridData[l]&&"stone"===this.gridData[l].type||o.push({row:i,col:s,path:[...t.path,{row:i,col:s}]})}}}return[]}executeMovementPath(t){if(0===t.length)return;this.isMoving=!0;let e=0;const i=()=>{if(e>=t.length)return this.isMoving=!1,void this.time.delayedCall(50,(()=>{this.checkItemCollection()}));const s=t[e],o=this.gridStartX+s.col*this.cellSize,a=this.gridStartY+s.row*this.cellSize;this.walkSound&&!this.walkSound.isPlaying&&this.walkSound.play(),this.characterPosition={row:s.row,col:s.col},this.tweens.add({targets:this.character,x:o,y:a,duration:200,ease:"Power2",onComplete:()=>{e++,i()}})};i()}checkItemCollection(){const t=`${this.characterPosition.row}x${this.characterPosition.col}`;for(let e=this.droppedItems.length-1;e>=0;e--){const i=this.droppedItems[e];if(i.name.replace("dropped_","")===t&&i.active){this.collectItem(i,e);break}}}collectItem(t,e){const i=t.name.replace("dropped_",""),s=this.gridItems[i];if(s){const o=s.itemType,a=o.charAt(0).toUpperCase()+o.slice(1);this.collectSound&&this.collectSound.play(),this.gameState.items.hasOwnProperty(a)?(this.gameState.items[a]++,console.log(`Get ${o} Amount: ${this.gameState.items[a]}`),this.updateItemDisplay()):console.log(`Get ${o}! (Vip item)`),this.tweens.add({targets:t,scaleX:1.5,scaleY:1.5,alpha:0,duration:300,ease:"Back.easeIn",onComplete:()=>{t.destroy(),this.droppedItems.splice(e,1)}}),delete this.gridItems[i]}}async loadGridFromServer(){console.log("Loading grid data..."),this.gridData={"0x0":{type:"stone"},"0x1":{type:"stone"},"0x2":{type:"stone"},"0x3":{type:"stone"},"0x4":{type:"stone"},"0x5":{type:"stone"},"1x0":{type:"stone"},"1x1":{type:"stone"},"1x2":{type:"stone"},"1x3":{type:"stone"},"1x4":{type:"stone"},"1x5":{type:"stone"},"2x0":{type:"stone"},"2x1":{type:"stone"},"2x2":{type:"stone"},"2x3":{type:"stone"},"2x4":{type:"stone"},"2x5":{type:"stone"},"3x0":{type:"stone"},"3x1":{type:"stone"},"3x2":{type:"stone"},"3x3":{type:"stone"},"3x4":{type:"stone"},"3x5":{type:"stone"},"4x0":{type:"stone"},"4x1":{type:"stone"},"4x2":{type:"stone"},"4x3":{type:"stone"},"4x4":{type:"stone"},"4x5":{type:"stone"},"5x0":{type:"stone"},"5x1":{type:"stone"},"5x2":{type:"stone"},"5x3":{type:"stone"},"5x4":{type:"stone"},"5x5":{type:"empty"}},this.gridItems={};const t=[{type:"pick",weight:30},{type:"drill",weight:25},{type:"radar",weight:20},{type:"mine",weight:15},{type:"gem",weight:7},{type:"medal",weight:3}];Object.keys(this.gridData).forEach((e=>{if("stone"===this.gridData[e].type&&Math.random()<.7){const i=t.reduce(((t,e)=>t+e.weight),0);let s=Math.random()*i,o="pick";for(const e of t)if(s-=e.weight,s<=0){o=e.type;break}this.gridItems[e]={itemType:o,isRevealed:!1,isDropped:!1}}})),console.log("Grid data loaded:",this.gridData),console.log("Grid items generated:",this.gridItems);const e={},i=Object.keys(this.gridData).filter((t=>"stone"===this.gridData[t].type)).length,s=Object.keys(this.gridItems).length;Object.values(this.gridItems).forEach((t=>{e[t.itemType]=(e[t.itemType]||0)+1})),console.log("Item distribution:",e),console.log(`Item spawn rate: ${s}/${i} (${Math.round(s/i*100)}%)`),console.log("Empty cells:",i-s)}createHighlightGraphics(){this.toolHighlight=this.add.graphics(),this.gridHighlight=this.add.graphics()}highlightTool(t,e,i,s){this.toolHighlight.clear(),this.toolHighlight.lineStyle(3,65280),this.drawDashedRect(this.toolHighlight,t,e,i,s)}highlightGrid(t,e,i,s){this.gridHighlight.clear(),this.gridHighlight.lineStyle(3,16776960),this.drawDashedRect(this.gridHighlight,t,e,i,s)}clearToolHighlight(){this.toolHighlight.clear()}clearGridHighlight(){this.gridHighlight.clear()}drawDashedRect(t,e,i,s,o){for(let a=0;a<s;a+=15){const o=Math.min(a+10,s);t.lineBetween(e+a,i,e+o,i)}for(let a=0;a<o;a+=15){const r=Math.min(a+10,o);t.lineBetween(e+s,i+a,e+s,i+r)}for(let a=0;a<s;a+=15){const r=Math.min(a+10,s);t.lineBetween(e+s-a,i+o,e+s-r,i+o)}for(let a=0;a<o;a+=15){const s=Math.min(a+10,o);t.lineBetween(e,i+o-a,e,i+o-s)}}createGridZones(t){const e=t.getObjectLayer("Map");e&&e.objects.forEach((t=>{const e=this.add.zone(t.x,t.y,t.width,t.height);e.setOrigin(0,0),e.setInteractive(),e.name=t.name,e.on("pointerdown",(()=>{console.log("Grid clicked:",e.name),this.onGridClick(e.name,t.x,t.y,t.width,t.height)})),e.on("pointerover",(()=>{this.selectedTool})),e.on("pointerout",(()=>{}))}))}createGridTiles(){this.gridData?(console.log("Creating grid tiles..."),Object.keys(this.gridData).forEach((t=>{const e=this.gridData[t],[i,s]=t.split("x").map(Number),o=399.357+80*s,a=557.491+80*i;if(console.log(`Processing ${t}: type=${e.type}, pos=(${o},${a})`),"empty"!==e.type){let e;console.log(`Creating stone tile at ${t}`),this.textures.exists("stone")?e=this.add.image(o,a,"stone"):(console.warn("Stone texture not found, using h-resource fallback"),e=this.add.sprite(o,a,"h_resource_tiles",0)),e.setOrigin(0,0),e.setDisplaySize(80,80),e.gridX=s,e.gridY=i,e.name=t,console.log("Tile created:",e)}})),console.log("Grid tiles creation completed")):console.log("No grid data available")}createObjectLayers(t){const e=t.getObjectLayer("Background");e&&!1!==e.visible&&e.objects.forEach((t=>{if(28===t.gid){const e=this.add.image(t.x,t.y-t.height,"background");e.setOrigin(0,0),e.setDisplaySize(t.width,t.height)}}));const i=t.getObjectLayer("Main");i&&i.objects.forEach((t=>{if(29===t.gid){const e=this.add.image(t.x,t.y-t.height,"main_bg");e.setOrigin(0,0),e.setDisplaySize(t.width,t.height)}}));const s=t.getObjectLayer("Floor");s&&s.objects.forEach((t=>{if(21===t.gid){const e=this.add.image(t.x,t.y-t.height,"floor");e.setOrigin(0,0),e.setDisplaySize(t.width,t.height)}}));const o=t.getObjectLayer("NextFloorButton");o&&o.objects.forEach((t=>{if(23===t.gid){const e=this.add.image(t.x,t.y-t.height,"next_button");e.setOrigin(0,0),e.setDisplaySize(t.width,t.height),e.setInteractive(),e.on("pointerdown",(()=>{console.log("Next Floor clicked"),this.onNextFloorClick()}))}}));const a=t.getObjectLayer("FloorText");a&&a.objects.forEach((t=>{if(t.text){const e={fontSize:t.text.pixelsize+"px",fontFamily:t.text.fontfamily||"Arial",color:t.text.color||"#ffffff",fontStyle:t.text.bold?"bold":"normal",align:"center"};let i=t.text.text;"FloorNumber"===t.name?(i=`Floor ${this.gameState.currentFloor}`,this.floorNumberText=this.add.text(t.x+t.width/2,t.y+t.height/2,i,e),this.floorNumberText.setOrigin(.5,.5)):this.add.text(t.x+t.width/2,t.y+t.height/2,i,e).setOrigin(.5,.5)}else if(22===t.gid){const e=this.add.image(t.x,t.y-t.height,"line");e.setOrigin(0,0),e.setDisplaySize(t.width,t.height)}}));const r=t.getObjectLayer("MenuItemBackground");r&&r.objects.forEach((t=>{if(26===t.gid){const e=this.add.image(t.x,t.y-t.height,"menu_item_bg");e.setOrigin(0,0),e.setDisplaySize(t.width,t.height)}}));const l=t.getObjectLayer("MenuItem");l&&l.objects.forEach((t=>{if(t.gid>=30&&t.gid<=33){const e=t.gid-30,i=this.add.sprite(t.x,t.y-t.height,"game_item_tiles",e);i.setOrigin(0,0),i.setDisplaySize(t.width,t.height),i.setInteractive(),i.name=t.name,i.on("pointerdown",(()=>{console.log("Tool clicked:",i.name),this.onToolClick(i.name,t.x,t.y-t.height,t.width,t.height)}))}}));const n=t.getObjectLayer("MenuItemAmount");n&&n.objects.forEach((t=>{if(t.text){const e={fontSize:t.text.pixelsize+"px",fontFamily:t.text.fontfamily||"Arial",color:t.text.color||"#ffffff"},i=this.add.text(t.x,t.y,t.text.text,e);i.name=t.name;const s=t.name.replaceAll("Amount","");i.text=this.gameState.items[s]||"0",this.itemAmountTexts[t.name]=i}}))}showItemEmptyDialog(t){this.errorSound&&this.errorSound.play();const e=this.cameras.main.worldView.centerX,i=this.cameras.main.worldView.centerY,s=this.add.graphics();s.fillStyle(0,.8),s.lineStyle(3,16777215),s.fillRect(e-200,i-100,400,200),s.strokeRect(e-200,i-100,400,200),s.setScrollFactor(0);const o=this.add.text(e,i-50,`Hết ${t}!`,{fontSize:"24px",fontFamily:"Arial",color:"#ff4444",fontStyle:"bold"});o.setOrigin(.5),o.setScrollFactor(0);const a=this.add.graphics();a.fillStyle(4474111),a.lineStyle(2,16777215),a.fillRect(e-50,i+30,100,40),a.strokeRect(e-50,i+30,100,40),a.setScrollFactor(0),a.setInteractive(new Phaser.Geom.Rectangle(e-50,i+30,100,40),Phaser.Geom.Rectangle.Contains);const r=this.add.text(e,i+50,"OK",{fontSize:"18px",fontFamily:"Arial",color:"#ffffff"});r.setOrigin(.5),r.setScrollFactor(0),a.on("pointerdown",(()=>{s.destroy(),o.destroy(),a.destroy(),r.destroy()})),this.time.delayedCall(3e3,(()=>{s.active&&(s.destroy(),o.destroy(),a.destroy(),r.destroy())}))}useItem(t,e){if(console.log(`Sử dụng ${t} tại ${e}`),this.gameState.items[t]<=0)return void this.showItemEmptyDialog(t);this.gameState.items[t]--,console.log(`${t} còn lại: ${this.gameState.items[t]}`),this.updateItemDisplay();const[i,s]=e.split("x").map(Number);switch(t){case"Pick":this.usePick(i,s);break;case"Drill":this.useDrill(i,s);break;case"Mine":this.useMine(i,s);break;case"Radar":this.useRadar(i,s)}this.clearToolHighlight(),this.clearGridHighlight(),this.selectedTool=null,this.selectedGrid=null}usePick(t,e){console.log(`Pick phá ô ${t}x${e}`),this.pickSound&&this.pickSound.play(),this.destroyCell(t,e)}useDrill(t,e){console.log(`Drill phá hình chữ thập tại ${t}x${e}`),this.drillSound&&this.drillSound.play(),[[t,e],[t-1,e],[t+1,e],[t,e-1],[t,e+1]].forEach((([t,e])=>{this.isValidPosition(t,e)&&this.destroyCell(t,e)}))}useMine(t,e){console.log(`Mine nổ 3x3 tại ${t}x${e}`),this.mineSound&&this.mineSound.play();for(let i=t-1;i<=t+1;i++)for(let t=e-1;t<=e+1;t++)this.isValidPosition(i,t)&&this.destroyCell(i,t)}useRadar(t,e){console.log(`Radar scan 3x3 tại ${t}x${e}`),this.radarSound&&this.radarSound.play();for(let i=t-1;i<=t+1;i++)for(let t=e-1;t<=e+1;t++)this.isValidPosition(i,t)&&this.previewItem(i,t)}previewItem(t,e){const i=`${t}x${e}`;if(this.gridData[i]&&"stone"===this.gridData[i].type&&this.gridItems[i]){const s=80,o=399.357+e*s,a=557.491+t*s,r=this.gridItems[i].itemType,l=this.add.image(o,a,`item_${r}`);l.setOrigin(0,0),l.setDisplaySize(s,s),l.setAlpha(.85),l.setTint(8978431);const n=this.add.image(o,a,`item_${r}`);n.setOrigin(0,0),n.setDisplaySize(s+10,s+10),n.setAlpha(.3),n.setTint(65535),n.setPosition(o-5,a-5),this.tweens.add({targets:[l,n],alpha:{from:l.alpha,to:.7*l.alpha},duration:800,yoyo:!0,repeat:-1,ease:"Sine.easeInOut"}),this.time.delayedCall(8e3,(()=>{l.active&&l.destroy(),n.active&&n.destroy()})),console.log(`Radar preview ${i}: item type ${r}`)}else if(this.gridData[i]&&"stone"===this.gridData[i].type){const s=80,o=399.357+e*s,a=557.491+t*s,r=this.add.text(o+s/2,a+s/2,"✗",{fontSize:"32px",fontFamily:"Arial",color:"#ff4444",fontStyle:"bold"});r.setOrigin(.5),r.setAlpha(.8),this.time.delayedCall(4e3,(()=>{r.active&&r.destroy()})),console.log(`Radar preview ${i}: empty cell`)}}isValidPosition(t,e){return t>=0&&t<6&&e>=0&&e<6}destroyCell(t,e){const i=`${t}x${e}`;this.gridData[i]&&"empty"!==this.gridData[i].type&&(this.gridData[i].type="empty",this.children.getChildren().forEach((t=>{t.name===i&&t.destroy()})),this.gridItems[i]&&!this.gridItems[i].isDropped?(this.dropItem(t,e),this.gridItems[i].isDropped=!0):this.gridItems[i]||console.log(`Ô ${i} không có vật phẩm`),console.log(`Đã phá ${i}`))}dropItem(t,e){const i=`${t}x${e}`,s=this.gridItems[i];if(!s)return;const o=399.357+80*e,a=557.491+80*t,r=s.itemType,l=this.add.image(o,a-100,`item_${r}`);l.setOrigin(0,0),l.setDisplaySize(80,80),l.name=`dropped_${i}`,this.tweens.add({targets:l,y:a,duration:500,ease:"Bounce.easeOut",onComplete:()=>{console.log(`Item dropped at ${i}: ${r}`),this.droppedItems.push(l)}})}updateItemDisplay(){if(console.log("Updating item display:",this.gameState.items),this.itemAmountTexts){const t={Pick:"PickAmount",Drill:"DrillAmount",Mine:"MineAmount",Radar:"RadarAmount"};Object.keys(t).forEach((e=>{const i=t[e];if(this.itemAmountTexts[i]){const t=this.gameState.items[e];this.itemAmountTexts[i].text=t.toString(),console.log(`Updated ${i} to ${t}`),t<=0?this.itemAmountTexts[i].setColor("#ff4444"):this.itemAmountTexts[i].setColor("#fefefe")}}))}else console.log("itemAmountTexts not available yet")}getCurrentFloor(){return this.gameState.currentFloor}getItemCount(t){return this.gameState.items[t]||0}getSelectedTool(){return this.selectedTool}getSelectedGrid(){return this.selectedGrid}clearAllSelections(){this.clearToolHighlight(),this.clearGridHighlight(),this.selectedTool=null,this.selectedGrid=null}onGridClick(t,e,i,s,o){setTimeout((()=>{if(console.log("Grid cell clicked:",t),!this.selectedTool)return void console.log("Please pick gird!");const[e,i]=t.split("x").map(Number);this.characterPosition.row===e&&this.characterPosition.col===i||(this.gridData[t]&&"stone"===this.gridData[t].type?this.useItem(this.selectedTool,t):console.log("Require stone gird!"))}),0)}onToolClick(t,e,i,s,o){console.log("Tool selected:",t),this.gameState.items[t]<=0?this.showItemEmptyDialog(t):(this.clearToolHighlight(),this.clearGridHighlight(),this.selectedTool=t,this.selectedGrid=null,this.highlightTool(e,i,s,o))}onNextFloorClick(){console.log("Next floor button clicked"),this.gameState.currentFloor++,this.clearAllSelections(),this.droppedItems.forEach((t=>t.destroy())),this.droppedItems=[],this.characterPosition={row:5,col:5},this.isMoving=!1,this.loadGridFromServer().then((()=>{this.createGridTiles();const t=this.gridStartX+this.characterPosition.col*this.cellSize,e=this.gridStartY+this.characterPosition.row*this.cellSize;this.character.setPosition(t,e)})),this.gameState.items.Pick+=1,this.gameState.items.Drill+=1,console.log(`Next floor ${this.gameState.currentFloor}`),console.log("Items:",this.gameState.items),this.updateItemDisplay(),this.floorNumberText&&this.floorNumberText.setText(`Floor ${this.gameState.currentFloor}`)}}const a={type:Phaser.AUTO,width:1280,height:1600,parent:"game-container",scene:[o],physics:{default:"arcade",arcade:{debug:!1}}};document.addEventListener("DOMContentLoaded",(()=>{new s.Game({...a,parent:"game-container"})}));
